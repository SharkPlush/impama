#!/bin/bash

# NOT MEANT TO BE USED CURRENTLY!!
# NEEDS UPDATE SYSTEM
# NEEDS DELETE SYSTEM
# NEEDS UPDATE SYSTEM FOR IMPAMA ITSELF
# NEEDS A CACHING SYSTEM SO IT KNOWS WHATS INSTALLED
# NEEDS A SYSTEM TO INSTALL PACKAGES ONE BY ONE TO PREVENT RACE CONDITIONS
# NEEDS A BETTER SYSTEM TO HANDLE MULTI PACKAGE INSTALLS

#!/bin/bash
# Impama CLI - minimal command parser

install_package () {
  SCRIPT_URL="https://raw.githubusercontent.com/SharkPlush/impama/main/install_scripts/$package-install.sh"
  tmpdir="/var/tmp/impama_tmp_install_dir/"
  mkdir -p "$tmpdir"
  echo "downloading $SCRIPT_URL"
  curl -fsSL "$SCRIPT_URL" -o "$tmpdir"
  chmod +x "$SCRIPT_PATH"
  echo "running installer for $package"
  sudo bash "$SCRIPT_PATH"
  echo "installed $package"
}

cmd="$1"
shift || true

if [[ "$cmd" == "install" ]]; then
  package="$1"
fi  
  if [[ -z "$package" ]]; then
    echo "Error: No package specified."
    exit 1
  else
    echo "Installing package: $package"
    install_package
  fi
  
if [[ "$cmd" == "help" ]]; then
  echo "impama usage:"
  echo "  impama install <package>  install a package."
  echo "  impama help               shows this help message."
fi
